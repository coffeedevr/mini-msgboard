extends layout

block content
  div#main-content
    div#main-header
      h2 Latest Threads
      div#create-thread-wrapper
        a#create-thread-link(href='/thread/new')
          h2 + Create a thread
    div#main-threads-wrapper
    ul#thread-list 
      each thread, key in threads
        li#thread-elements
          div#thread-title-wrapper
            a#thread-title(target="_self" href="/thread/" + thread._id)
              if thread.flair == 'Discussion'
                img#thread-logo(src="/images/thread-discuss.png")
              if thread.flair == 'General'
                img#thread-logo(src="/images/thread-general.png")
              if thread.flair == 'Question'
                img#thread-logo(src="/images/thread-question.png")
              p #{thread.title}
                <span id="thread-flair"> #{thread.flair} </span>
            p#thread-pages= 'Jump to: '
              - for (let i = 1; i <= threadpage[key]; i++) {
                -  if (i > 5) {
                    a(href='/thread/' + thread._id + '/' + i)= '[...' + threadpage[key] + ']' 
                -    break 
                - }   else { 
                    a(href='/thread/' + thread._id + '/' + i)= '[' + i + '] '
                -   }
              - }
          p#thread-user posted #{thread.date_created_formatted} <br/> thread by #{thread.user}
      else 
        li There are no threads

    div#thread-controls
      div#page-threads
        if prevpage >= 1
          a.page-controls(href="/page/" + prevpage) Prev Page
        else 
          p.page-controls
        if nextpage > 1 && nextpage != page
          a.page-controls(href="/page/" + nextpage) Next Page
        else
          p.page-controls
  div#sidebar-content
    div#recent-content
      div#sidebar-header
        h2#sidebar-title-text Recent Replies
      ul 
        each msg in messages 
          li
            p #{msg.message}
            a(target="_self" href="/thread/" + msg.thread_id) Visit thread.
        else
          li No replies.

